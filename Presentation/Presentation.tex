%%!TEX encoding = UTF-8 Unicode 
\documentclass{beamer}
\let\Tiny=\tiny

%\mode<presentation>{
  %\usetheme{Singapore}
  %\usecolortheme{rose}
  %\usefonttheme{structurebold}
  %\setbeamertemplate{caption}[numbered]
%} 
\mode<presentation>{
  \usetheme{Boadilla}
  \usecolortheme{whale}
  \usefonttheme{structurebold}
  \setbeamertemplate{caption}[numbered]
} 

%\usepackage{pgfplots}
\usepackage{verbatim}
%\pgfplotsset{compat=1.8}
%\pgfplotsset{grid style={dashed}}

\usepackage{listings}
\lstset{
    tabsize=4,
    basicstyle=\ttfamily,
    frame=single,
    captionpos=b,
    breaklines=true,
    columns=flexible,
}

\usepackage[english]{babel}
\usepackage[utf8x]{inputenc}

\usepackage{todonotes}
\usepackage{multirow}
\usepackage{pgfpages}
\pgfpagesuselayout{resize to}[physical paper width=8in, physical paper height=6in]

\title{
    GMetis - Xeon Phi
}

\author{
    David Pereira
    \and
    Rui Brito
}

\date{\today}


\begin{document}

\begin{frame}
  \titlepage
\end{frame}

\begin{frame}{Outline}
  \tableofcontents
\end{frame}


%-----------------------------------------------------------------------------
% Introduction
%-----------------------------------------------------------------------------

\section{Introduction}

\begin{frame}{Introduction}
\begin{itemize}
    \item GMetis is a graph partitioning application which uses the Galois
      framwork
    \item Consists of three major phases
      \begin{itemize}
        \item Coarsening
        \begin{itemize}
          \item Find matching nodes
          \item Coarsen Graph
        \end{itemize}
        \item Initial Paritioning (Clustering)
        \item Refinement
      \end{itemize}
\end{itemize}
\end{frame}


%-----------------------------------------------------------------------------
% Algorithm Description
%-----------------------------------------------------------------------------

\section{Algorithm Description}

\begin{frame}{Algorithm Description}
  \begin{center}
  \begin{figure}[htbp]
      \includegraphics[scale=.5]{img/metis.png}
  \end{figure}
  \end{center}
\end{frame}

\begin{frame}{Formal Description}

\begin{itemize}
  \item Given a graph $G_0 = (V_0,E_0)$:
  \begin{itemize}    
    \item Coarsening
    \begin{itemize}
      \item For a given graph $G_0$ is transformed into a sequence of smaller graphs $G_1,G_2,\cdots,G_m$ such that $|V_0|>|V_1|>|V_2|>\cdots>|V_m|$
    \end{itemize}
    \item Partitioning 
    \begin{itemize}
      \item A 2-way partitiom $P_m$ of the graph $G_m = (V_m,E_m)$ is computed that partitions $V_m$ into two parts, each containng half the vertices of $G_0$
    \end{itemize}
    \item Refinement
    \begin{itemize}
      \item The partition $P_m$ of $G_m$ is projected back to $G_0$ by going through intermediate partitions $P_{m-1}, P_{m-2},\cdots,P_1,P_0 $
    \end{itemize}
  \end{itemize}
\end{itemize}
  
\end{frame}


%-----------------------------------------------------------------------------
% System characteristics
%-----------------------------------------------------------------------------

\section{System characteristics}

\begin{frame}{Stampede Host}
\begin{table}[H]
\centering
\footnotesize
\begin{tabular}{| c | c |}\hline
Manufacturer & Intel\\ \hline
Model & Xeon E5-2680\\ \hline
$\mu$Arch & Sandy Bridge\\ \hline
Clock freq & 2.70 GHz\\ \hline
\#CPUs (sockets) & 2 \\ \hline
\#Cores/CPU & 8\\ \hline
\#Thread/Core & 1\\ \hline
L1 cache size/core & 32 KB\\ \hline
L2 cache size/core & 256 KB\\ \hline
L3 shared cache size/CPU & 20 MB\\ \hline
Vector width & 256 bits (AVX)\\ \hline
%FIXME: Ver se se põe GFlops. Talvez nao seja preciso. De resto, a informação
%está correcta. Pode-se acrescentar ou remover alguma coisa.
%Peak SP Gflops/s & 256.32 \\ \hline
%Peak DP Gflops/s & 128.16 \\ \hline
\end{tabular}
\caption{Intel Xeon E5-2680}
\end{table}
\end{frame}

%TODO: por aqui a imagem do HWLock? - depois decidir se fica ou não

\begin{frame}{Stampede Coprocessor - Xeon Phi}
\begin{table}[H]
\centering
\footnotesize
\begin{tabular}{| c | c |}\hline
Manufacturer & Intel\\ \hline
Model & Xeon E5-2680\\ \hline
$\mu$Arch & Sandy Bridge\\ \hline
Clock freq & 1.1 GHz\\ \hline
\#CPUs (sockets) & 1 \\ \hline
\#Cores/CPU & 61\\ \hline
\#Thread/Core & 4\\ \hline
L1 cache size/core & 32KB\\ \hline
L2 cache size/core & 512 KB\\ \hline
Vector width & 512 bits\\ \hline
Peak SP Gflops/s & 2112\\ \hline
Peak DP Gflops/s & 1056\\ \hline
\end{tabular}
\caption{Intel Xeon Phi}
\end{table}
\end{frame}

\begin{frame}{Important characteristics}
  \begin{itemize}
    \item Four hardware threads per core
    \item In-order dual issue pipeline
    \item Pipeline does not issue instructions from the same hardware
      context for two consecutive clock cycles
    \item Maximum issue rate only attainable with at least 2 threads per
      core
  \end{itemize}
\end{frame}

\begin{frame}
\begin{table}[H]
\centering
\footnotesize
\begin{tabular}{| c | c |}\hline
Number of Hardware Threads per core & Minimum Theoretical CPI per Core\\ \hline
1 & 1\\ \hline
2 & 0.5\\ \hline
3 & 0.5\\ \hline
4 & 0.5\\ \hline
\end{tabular}
\caption{Minimum Theoretical CPIs}
\end{table}
\end{frame}

%-----------------------------------------------------------------------------
% Metis
%-----------------------------------------------------------------------------

\section{Metis}

\begin{frame}
%\begin{center}
%\begin{figure}[htbp]
    %\includegraphics[scale=.35]{.png}
%\end{figure}
%\end{center}
\end{frame}


%-----------------------------------------------------------------------------
% Mt-metis
%-----------------------------------------------------------------------------

\begin{frame}
%\begin{center}
%\begin{figure}[htbp]
    %\includegraphics[scale=.35]{.png}
%\end{figure}
%\end{center}
\end{frame}


%-----------------------------------------------------------------------------
% GMetis
%-----------------------------------------------------------------------------

\begin{frame}
%\begin{center}
%\begin{figure}[htbp]
    %\includegraphics[scale=.35]{.png}
%\end{figure}
%\end{center}
\end{frame}

%TODO: Por no fim cenas sobre edgecuts para efeitos de comparação.
%TODO: Por melhorias feitas.


%-----------------------------------------------------------------------------
% Conclusion
%-----------------------------------------------------------------------------

\section{Conclusion}

\begin{frame}{Conclusion}
\begin{itemize}
  \item Metis and mt-metis have better edgecut
  \item Metis and mt-metis have lower runtime for small number of
    partitions
  \item GMetis is faster for high number of partitions
  \item Metis graph partitioning algorithm is not suitable to run on MIC
    as it do not harness vector
  % no entanto, não é razão para problemas de escalabilidade
  \item Metis and mt-metis are writen in C whereas GMetis is writen in
    C++ and uses Templates. This may explain diferences in performance
\end{itemize}
\end{frame}


%-----------------------------------------------------------------------------
% End Page 
%-----------------------------------------------------------------------------

\begin{frame}
  \titlepage
  \begin{center}
  \huge Questions \& Discussion
  \end{center}
\end{frame}

\end{document}
